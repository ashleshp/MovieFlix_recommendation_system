Device set to use cpu
Using device: cuda
Saved model found. Loading model and data...
Model and data loaded.
TwoTowerService is running on port 12352
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
D:\bremen\fate\ubung\assignment1\aia-e-assignments-group-8\Project\two_tower_service.py:174: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at C:\bld\libtorch_1739475077952\work\torch\csrc\utils\tensor_new.cpp:257.)
  new_user_history = torch.tensor(new_user_history, dtype=torch.float).unsqueeze(0).to(device)
Received request: {'request_type': 'recommend', 'new_user_preferences': {'userId': [9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999], 'title': ['Louis C.K.: Hilarious', 'Fresh Hare', "Bon Voyage, Charlie Brown (and Don't Come Back!)", 'Transylvania Twist', "Who's Your Daddy?", "It's Christmastime Again, Charlie Brown", "Carry On Don't Lose Your Head", "Who's Your Caddy?", 'Sing Your Way Home', "Take Her, She's Mine", "Goin' to Town", 'Carry On... Up the Khyber', "That'll Be The Day", "Keep 'Em Flying", "Comin' at Ya!", "Gimme an 'F'", 'Waitress!', 'Louis C.K.: Oh My God', 'Uncle Nick', "John Pinette: I'm Starvin'!", "Daddy's Home", "Not the Messiah (He's a Very Naughty Boy)", "George Lopez: It's Not Me, It's You", "Don't Tell Her It's Me", "What's Up, Tiger Lily?", "The Girl Can't Help It", "Who's Minding The Mint?", "C'mon, Let's Live a Little", "Not With My Wife, You Don't!", "Let's Go Navy!", "Don't Drink the Water", 'Carry On Cowboy', "You're a Good Man, Charlie Brown", "The Man Who Couldn't Say No", 'All the Way Home', "Can't Buy My Love", 'Carry On Screaming', 'Carry On Constable', 'Carry On Spying', 'Carry On Teacher', "Ride 'Em Cowboy", "Moms Mabley: I Got Somethin' to Tell You", 'Blindman', "Up 'n' Under", 'Get Mean', "I'll Never Forget What's'isname", "Everybody's Got Somebody... Not Me", "If You Don't Stop It...You'll Go Blind!!!", 'Ten Zan - Ultimate Mission'], 'rating': [5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'nos': 5}
New user preferences with genres:
    userId  ...                   genres
0     9999  ...                   Comedy
1     9999  ...         Comedy,Animation
2     9999  ...  Animation,Comedy,Family
3     9999  ...                   Comedy
4     9999  ...                   Comedy
5     9999  ...                Animation
6     9999  ...                   Comedy
7     9999  ...                   Comedy
8     9999  ...                   Comedy
9     9999  ...                   Comedy
10    9999  ...                   Comedy
11    9999  ...         Adventure,Comedy
12    9999  ...              Music,Drama
13    9999  ...                   Comedy
14    9999  ...                  Western
15    9999  ...                   Comedy
16    9999  ...                   Comedy
17    9999  ...                   Comedy
18    9999  ...                   Comedy
19    9999  ...                   Comedy
20    9999  ...                   Comedy
21    9999  ...     Comedy,Music,History
22    9999  ...                   Comedy
23    9999  ...           Comedy,Romance
24    9999  ...            Action,Comedy
25    9999  ...                   Comedy
26    9999  ...           Comedy,Romance
27    9999  ...             Music,Comedy
28    9999  ...                   Comedy
29    9999  ...                   Comedy
30    9999  ...                   Comedy
31    9999  ...           Comedy,Western
32    9999  ...  Animation,Family,Comedy
33    9999  ...                   Comedy
34    9999  ...                    Drama
35    9999  ...                  Romance
36    9999  ...                   Comedy
37    9999  ...                   Comedy
38    9999  ...                   Comedy
39    9999  ...                   Comedy
40    9999  ...           Comedy,Western
41    9999  ...                      NaN
42    9999  ...                  Western
43    9999  ...                   Comedy
44    9999  ...                  Western
45    9999  ...             Comedy,Drama
46    9999  ...                    Drama
47    9999  ...                   Comedy
48    9999  ...    Thriller,Action,Drama

[49 rows x 6 columns]
User Preferred Genres: {'Adventure', 'Animation', 'Drama', 'Comedy', 'Music', 'Family', 'Western'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
Received request: {'request_type': 'status'}
